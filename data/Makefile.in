#                         Copyright (c) 2000 - 2008
#                  Lawrence Livermore National Security, LLC
#            Produced at the Lawrence Livermore National Laboratory
#                              LLNL-CODE-400124
#                            All rights reserved.
#
# This file is  part of VisIt. For  details, see https://visit.llnl.gov/.  The
# full copyright notice is contained in the file COPYRIGHT located at the root
# of the VisIt distribution or at https://visit.llnl.gov/copyright.html.
#
# Redistribution  and  use  in  source  and  binary  forms,  with  or  without
# modification, are permitted provided  that the following conditions are met:
#
# - Redistributions of  source code  must retain  the above  copyright notice,
#   this list of conditions and the disclaimer below.
# - Redistributions in binary form must  reproduce the above copyright notice,
#   this  list of  conditions  and  the  disclaimer  (as noted below)  in  the
#   documentation and/or other materials provided with the distribution.
# - Neither the name of the LLNS/LLNL nor the names of its contributors may be
#   used to endorse  or promote products  derived from  this software  without
#   specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE  COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR  IMPLIED WARRANTIES,  INCLUDING, BUT NOT  LIMITED TO, THE
# IMPLIED WARRANTIES  OF MERCHANTABILITY AND FITNESS FOR  A PARTICULAR PURPOSE
# ARE  DISCLAIMED. IN  NO EVENT  SHALL LAWRENCE  LIVERMORE NATIONAL  SECURITY,
# LLC, THE  U.S.  DEPARTMENT OF  ENERGY  OR  CONTRIBUTORS BE  LIABLE  FOR  ANY
# DIRECT,  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  DAMAGES
# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
# LOSS OF USE, DATA, OR PROFITS; OR  BUSINESS INTERRUPTION) HOWEVER CAUSED AND
# ON ANY THEORY OF  LIABILITY, WHETHER IN CONTRACT, STRICT  LIABILITY, OR TORT
# (INCLUDING  NEGLIGENCE OR  OTHERWISE) ARISING IN ANY  WAY OUT OF  THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
# Modifications:
#
#   Hank Childs, Tue May  7 16:43:37 PDT 2002
#   Added specmix and wave.
#
#   Brad Whitlock, Fri Jun 21 13:35:15 PST 2002
#   Added noise and tire.
#
#   Eric Brugger, Fri Jul 19 14:44:33 PDT 2002
#   Added sid97.
#
#   Hank Childs, Wed Nov 13 15:59:46 PST 2002
#   Added bigsil.
#
#   Hank Childs, Wed Jan 15 09:39:31 PST 2003
#   Added curve_builder.
#
#   Kathleen Bonnell, Wed Sep  3 13:30:41 PDT 2003 
#   Added noise2d.
#
#   Brad Whitlock, Thu Sep 25 08:49:21 PDT 2003
#   Added pdbdatabase.C so we have a representative PDB database.
#
#   Mark C. Miller, Tue Nov 11 18:07:58 PST 2003
#   Added targets for binary data file uncompression
#   Added samrai data file
#
#   Eric Brugger, Wed Nov 19 16:32:00 PST 2003
#   I created a NOT_DISTRIB line with samrai_test_data so that it would
#   not be added to the distribution since it is a directory created
#   from a gzipped tar file.
#
#   Eric Brugger, Thu Nov 20 14:21:08 PST 2003
#   I modified the clean target to also remove data files.
#
#   Brad Whitlock, Fri Dec 5 08:25:06 PDT 2003
#   Added ANALYZE data file.
#
#   Eric Brugger, Wed Dec 31 09:39:54 PST 2003
#   I added samrai_ale2d_data.
#
#   Mark C. Miller, Wed Jan  7 15:18:06 PST 2004
#   I consolidated data from samrai_ale2d_data with samrai_test_data
#
#   Eric Brugger, Fri Feb  6 09:35:50 PST 2004
#   I added samrai_test_data and ANALYZE_test_data to NOT_DISTRIB.
#
#   Brad Whitlock, Sun Feb 1 02:24:15 PDT 2004
#   I added correlationtest.C
#
#   Mark C. Miller, Fri Feb 27 00:00:00 PST 2004
#   Added ../include and ../include/visit to CPPFLAGS to support building
#   pdb stuff with PDB lite
#
#   Mark C. Miller, Mon Mar  8 20:18:06 PST 2004
#   Added code to build a multi-part multi_ucd3d.silo file using
#   visit -convert
#
#   Brad Whitlock, Tue Mar 23 14:53:48 PST 2004
#   I added -I. to the include path.
#
#   Brad Whitlock, Tue Mar 30 09:06:02 PDT 2004
#   I added PDB_EXEC so we can successfully execute all PDB tests.
#
#   Hank Childs, Wed Aug 25 16:55:41 PDT 2004
#   Added degen_meshes.C
#
#   Hank Childs, Fri Aug 27 09:27:07 PDT 2004
#   Do not build degen_meshes by default, since there are LD_LIB_PATH issues.
#
#   Hank Childs, Tue Oct  5 09:24:05 PDT 2004
#   Add global_node.C
#
#   Mark C. Miller, Mon Nov 29 18:52:41 PST 2004
#   Moved larger files to NOT_DISTRIB. Added test for existence of to sid97
#   before executing it.
#
#   Mark C. Miller, Wed Dec  8 18:35:03 PST 2004
#   Removed sid97 from NOT_DISTRIB as it was causing problems for compile
#   in data dir. Added old silo test data
#
#   Jeremy Meredith, Fri Dec 10 14:14:18 PST 2004
#   Added support for version-specific visit scripts and the ability to
#   launch tools without passing them as an argument to the visit script.
#
#   Mark C. Miller, Tue Jan 18 12:44:34 PST 2005
#   Changed invokation of convert
#
#   Mark C. Miller, Fri Feb 11 10:21:40 PST 2005
#   Added testh5 target
#
#   Jeremy Meredith, Tue Feb 22 19:01:42 PST 2005
#   Renamed convert to visitconvert because it is more unique.
#
#   Jeremy Meredith, Fri Mar  4 13:28:20 PST 2005
#   Added ghost zone creation test data set.
#
#   Mark C. Miller, Mon Mar 21 18:47:40 PST 2005
#   Included ghost.C in SRC, added it to HDF5 output too
#
#   Brad Whitlock, Mon Mar 28 10:59:45 PDT 2005
#   Added shapefile data.
#
#   Hank Childs, Wed Mar 30 11:32:02 PST 2005
#   Add Mili, Boxlib, and Exodus files.
#
#   Brad Whitlock, Fri Apr 1 14:54:39 PST 2005
#   I zipped up the tecplot files.
#
#   Mark C. Miller, Wed May 11 08:11:27 PDT 2005
#   Added quad_disk.C
#
#   Jeremy Meredith, Tue Jun  7 10:07:44 PDT 2005
#   Added emptydomains.C
#
#   Hank Childs, Tue Jun 14 16:38:01 PDT 2005
#   Added KullLite test data.
#
#   Brad Whitlock, Thu Jul 7 18:32:56 PST 2005
#   Added NASTRAN and ANSYS test data.
#
#   Brad Whitlock, Wed Jul 20 17:31:18 PST 2005
#   Added galaxy.C
#
#   Brad Whitlock, Fri Jul 29 17:46:00 PST 2005
#   Added PATRAN test data.
#
#   Hank Childs, Fri Aug  5 10:17:52 PDT 2005
#   Add distribution_curves.
#
#   Mark C. Miller, Wed Aug 17 10:47:33 PDT 2005
#   Added visus test data
#
#   Brad Whitlock, Tue Aug 23 16:33:56 PST 2005
#   Added netcdf test data.
#
#   Brad Whitlock, Fri Sep 2 13:48:07 PST 2005
#   Added CGNS test data.
#
#   Brad Whitlock, Thu Sep 8 16:31:41 PST 2005
#   Added GDAL test data.
#
#   Kathleen Bonnell, Fri Sep 23 10:29:14 PDT 2005
#   Added vtk-xml test data.
#
#   Hank Childs, Wed Sep 28 08:53:22 PDT 2005
#   Added Dune test data.
#
#   Brad Whitlock, Mon Oct 3 13:59:12 PST 2005
#   Added lowfrac.C
#
#   Mark C. Miller, Thu Nov 10 14:31:50 PST 2005
#   Added overlink test data
#
#   Eric Brugger, Fri Nov 18 10:22:08 PST 2005
#   I added the pthread and x libraries to any link line that included vtk.
#
#   Mark C. Miller, Tue Feb  7 11:16:18 PST 2006
#   Prepended '-' to all subshell invokations so that if they fail, other
#   make won't exit
#
#   Kathleen Bonnell, Wed Feb  8 15:45:28 PST 2006 
#   Added vtk_cylindrical_test_data, renamed boxlib_2D_test_data.tar.bz2 to
#   boxlib_2D_test_data.tar.bz2, renamed vtk_xml_test_data.tar.bz2  to 
#   vtk_xml_test_data.tar.gz (since it's not binary data), made the xml data
#   'live' in a subdirectory for cleanup purposes.  Added a few items to
#   clean target.
#
#   Brad Whitlock, Thu Mar 16 17:32:25 PST 2006
#   Added a file to create BOV data.
#
#   Brad Whitlock, Tue Mar 28 15:38:21 PST 2006
#   Added ProteinDataBank test data.
#
#   Brad Whitlock, Tue Jun 27 10:25:47 PDT 2006
#   Added EnSight test data.
#
#   Brad Whitlock, Thu Jul 20 14:05:04 PST 2006
#   Added FITS test data.
#
#   Brad Whitlock, Tue Jul 25 09:23:49 PDT 2006
#   Added fullframe.C
#
#   Mark C. Miller, Tue Sep  5 10:17:20 PDT 2006
#   Added bov.C and fullframe.C to SRC and clean target
#
#   Eric Brugger, Wed Sep  6 10:58:48 PDT 2006
#   Added GGCM test data.
#
#   Hank Childs, Fri Sep  8 14:16:41 PDT 2006
#   Added Fluent and OpenFOAM test data.
#
#   Brad Whitlock, Mon Sep 25 14:11:43 PST 2006
#   Added Chombo test data.
#
#   Eric Brugger, Wed Oct 18 12:21:43 PDT 2006
#   Added Enzo test data.
#
#   Mark C. Miller, Tue Nov 28 23:13:08 PST 2006
#   Changed clean target to remove specific .visit files not *.visit
#
#   Mark C. Miller, Fri Dec  1 15:08:16 PST 2006
#   Added csg test data binary files
#
#   Dave Bremer, Tue Feb 13 18:01:29 PST 2007
#   Added raw miranda test data
#
#   Mark C. Miller, Tue Mar  6 10:34:25 PST 2007
#   Made NOT_DISTRIB target use filename pattern matching to reduce chances
#   someone will 'forget' to include a large binary file there. Also
#   added some flash data.
#
#   Eric Brugger, Thu Mar 22 10:33:51 PDT 2007
#   Added MESA_LIBS and GL_LIBS since they are no longer included in VTK_LIBS.
#
#   Thomas R. Treadway, Tue Mar 27 15:23:50 PDT 2007
#   Corrected syntax error
#
#   Gunther H. Weber, Thu Apr 19 18:22:49 PDT 2007
#   Adaptively replace relative visit path
#
#   Hank Childs, Wed Jun 13 10:46:06 PDT 2007
#   Added program thinplane.
#
#   Dave Bremer, Thu Jun 14 20:02:18 PDT 2007
#   Added NEK3D test data
#
#   Mark C. Miller, Thu Jun 28 15:28:58 PDT 2007
#   Made the clean target remove only c0*.curve files instead of *.curve
#
#   Eric Brugger, Tue Oct  9 14:28:43 PDT 2007
#   Added ddcMD test data.
#
#   Brad Whitlock, Wed Oct 10 11:44:03 PDT 2007
#   Added Cale, RAW test data files.
#
#   Brad Whitlock, Thu Dec 13 16:45:04 PST 2007
#   Added meshorigin.C
#
#   Eric Brugger, Fri Apr 18 11:32:53 PDT 2008
#   I added XDMF test data, both in the form of data files and source code
#   that generates XDMF files.  I added an infrastructure to optionally build
#   source code that depends on HDF5 (which the XDMF source code does).
#
#   Mark C. Miller, Tue Jun 17 18:16:45 PDT 2008
#   Added '-no_options' to visitconvert invokations
#
#   Mark C. Miller, Mon Oct 20 23:12:05 PDT 2008
#   Put silo dependent sources in their own list and made _TARGET variable
#   generated from that list instead of re-enumerating the same list but
#   without the '.C' on the filenames. Made similar adjustments for PDB
#   and HDF5 dependent sources. Introduced XXX_TARGET variable to make it
#   more consistent with VAC_ARG_WITH3RD() macro behavior in configure in
#   anticipation of using that macro for SILO and PDB in near future.
#   Added clean targets to clean just source, just binary data, etc.
#   Added rpath option so links with shared libs like HDF5 don't cause tests
#   to fail due to LD_LIBRARY_PATH not being set correctly. Removed PDB_EXEC
#   and HDF5_EXEC and replaced with shell code to test for existence of
#   files to be executed before executing them.
#
#   Eric Brugger, Wed Oct 22 16:18:41 PDT 2008
#   Changed the setting of LDFLAGS to use DATA_EXE_LDFLAGS instead of
#   unconditionally setting the rpath, which doesn't work on non-linux
#   systems.
#
#   Tom Fogal, Sat Oct 25 13:10:34 MDT 2008
#   I qualified a couple paths so that a user does not need `.' in their PATH.
#
#   Brad Whitlock, Fri Nov  7 11:36:41 PST 2008
#   Added streak.C
# 
##############################################################################

##
## Programs and options...
##
@SET_MAKE@
@VARIABLES@

NOT_DISTRIB=near_planar.vtk *_test_data *.tar.bz2 *.tar.gz *.tar.bz \
            miranda_raw

EZSRC=bov.C curve_builder.C degen_meshes.C distribution_curves.C
EZ_TARGET=$(EZSRC:.C=)

##
## Optional programs.
##
PDBSRC=pdbdatabase.C correlationtest.C streak.C pdbdatabase_link.C
PDB_TARGET=$(PDBSRC:.C=)

HDF5SRC=xdmf.C
HDF5_TARGET=$(HDF5SRC:.C=)

SILOSRC=bigsil.C csg.C emptydomains.C fullframe.C galaxy.C ghost.C \
        global_node.C globe.C largefile.C lineout_test.C lowfrac.C \
        meshorigin.C multi_test.C noise.C noise2d.C one_quad.C \
        quad_disk.C sid97.C specmix.C testall.C thinplane.C tire.C \
        wave.C
SILO_TARGET=$(SILOSRC:.C=)
#SILO_TARGET=`echo $(SILOSRC) | sed -e 's/\.C//g'` is an alternative

##
## Optional compressed binary data files (w/o extensions)
##
BINSRC=samrai_test_data ANALYZE_test_data Vista_test_data Image_test_data \
       pixie_test_data old_silo_data shapefile_test_data mili_test_data \
       boxlib_test_data exodus_test_data tecplot_test_data \
       KullLite_test_data NASTRAN_test_data ANSYS_test_data PATRAN_test_data \
       visus_test_data netcdf_test_data CGNS_test_data GDAL_test_data \
       vtk_xml_test_data dune_test_data overlink_test_data \
       vtk_cylindrical_test_data ProteinDataBank_test_data \
       Fluent_test_data OpenFOAM_test_data EnSight_test_data \
       FITS_test_data GGCM_test_data Chombo_test_data Enzo_test_data \
       csg_test_data miranda_raw FLASH_test_data iTaps_test_data \
       nek3d_test_data visitdiff_test_data odd_multi.silo claw_test_data \
       ddcmd_test_data Cale_test_data RAW_test_data


##
## Libraries and includes...
##
LIBS=$(SILO_LIB) @LIBS@
MATH_LIBS_ONLY=@LIBS@
LDFLAGS=@LDFLAGS@ @DATA_EXE_LDFLAGS@
CXXFLAGS=$(HDF5_INCLUDE) @CXXFLAGS@
CPPFLAGS=@CPPFLAGS@ -I. -I@DATA_REL_VISIT_PATH@/include -I@DATA_REL_VISIT_PATH@/include/visit @SILO_INCLUDE@ @PDB_FLAGS@ @VTK_INCLUDES@

##
## Files...
##
SRC=$(EZSRC) $(SILOSRC) $(PDBSRC) $(HDF5SRC)
OBJ=$(SRC:.C=.o)

##
## Standard targets...
##
all: $(EZ_TARGET) @SILO_TARGET@ @HDF5_TARGET@ $(PDB_TARGET) $(BINSRC)

test: $(EZ_TARGET)  @SILO_TARGET@ @HDF5_TARGET@ $(PDB_TARGET) $(BINSRC)
	./bigsil
	./curve_builder
	./global_node
	./globe
	./multi_test
	-@if test -x ../src/exe/visitconvert_ser; then \
	    ../src/bin/visitconvert multi_ucd3d.silo multipart_multi_ucd3d Silo -no_options; \
	fi
	./noise
	./noise2d
	./specmix
	./testall
	./tire
	./wave
	./wave -single_file
	./sid97
	./ghost
	./quad_disk
	./emptydomains
	./galaxy
	./distribution_curves
	./csg
	./lowfrac
	./bov
	./one_quad
	./fullframe
	./thinplane
	./meshorigin
	./lineout_test
	-@if test -e /home/visit/data/sesame.pdb; then \
	    ln -sf /home/visit/data/sesame.pdb . ;\
        elif test -e /project/projectdirs/visit/data/sesame.pdb; then \
	    ln -sf /project/projectdirs/visit/data/sesame.pdb . ;\
	else \
	    echo "" > SESAME_NOT_FOUND ;\
	    ln -sf SESAME_NOT_FOUND sesame.pdb ;\
	fi
	-@if test -e /usr/gapps/visit/data/largefile.silo; then \
	    ln -sf /usr/gapps/visit/data/largefile.silo . ;\
        elif test -e /project/projectdirs/visit/data/largefile.silo; then \
	    ln -sf /project/projectdirs/visit/data/largefile.silo . ;\
	else \
	    echo "" > LARGEFILE_NOT_FOUND ;\
	    ln -sf LARGEFILE_NOT_FOUND largefile.silo ;\
	fi
	-@for f in $(HDF5_TARGET); do \
	    if test -x $$f; then \
	        ./$$f ;\
	    fi \
	done
	-@for f in pdbdatabase correlationtest streak; do \
	    if test -x $$f; then \
	        ./$$f ;\
	    fi \
	done

testh5: @SILO_TARGET@ @HDF5_TARGET@ 
	-@if test -n "`echo $(SILO_LIB) | grep hdf5`"; then \
	   echo "***********************************" ;\
	   echo "***********************************" ;\
	   echo "Building Silo Data With HDF5 Driver" ;\
	   echo "***********************************" ;\
	   echo "***********************************" ;\
	   ./bigsil -driver DB_HDF5;\
	   ./global_node -driver DB_HDF5;\
	   ./globe -driver DB_HDF5;\
	   ./multi_test -driver DB_HDF5;\
	   if test -x ../src/exe/visitconvert_ser; then \
	      ../src/bin/visitconvert multi_ucd3d.silo multipart_multi_ucd3d Silo -no_options; \
	   fi;\
	   ./noise -driver DB_HDF5;\
	   ./noise2d -driver DB_HDF5;\
	   ./specmix -driver DB_HDF5;\
	   ./testall -driver DB_HDF5;\
	   ./tire -driver DB_HDF5;\
	   ./wave -driver DB_HDF5;\
	   ./wave -driver DB_HDF5 -single_file;\
	   ./sid97 -driver DB_HDF5;\
	   ./ghost -driver DB_HDF5;\
	   ./quad_disk -driver DB_HDF5;\
	   ./emptydomains -driver DB_HDF5;\
	   ./galaxy -driver DB_HDF5;\
	   ./csg -driver DB_HDF5;\
	   ./lowfrac -driver DB_HDF5;\
	   ./one_quad -driver DB_HDF5; \
	   ./fullframe -driver DB_HDF5; \
	   ./thinplane -driver DB_HDF5; \
           ./meshorigin -driver DB_HDF5; \
           ./lineout_test -driver DB_HDF5; \
	else \
	   echo "HDF5 driver for Silo not available in this configuration" ;\
	   exit 1;\
	fi

install: install_bin

bin_data_clean:
	$(RM) -r $(BINSRC)

gen_data_clean:
	$(RM) c0*.curve family*.pdb multi*.pdb db*.pdb allinone*.pdb sesame.pdb *.silo hist* distribution.ultra multi_ucd3d*
	$(RM) curve.visit wave*.visit *.bov multi00*.values *_indices*.values
	$(RM) wave_1file* wave_tv_1file*
	$(RM) [a-z]*.xmf mesh.h5

src_clean:
	$(RM) $(OBJ) $(EZ_TARGET) @SILO_TARGET@ @HDF5_TARGET@ $(PDB_TARGET)

clean: bin_data_clean gen_data_clean src_clean

##
## Other targets...
##
./bigsil: bigsil.o
	$(CXX) -o $@ bigsil.o $(LDFLAGS) $(LIBS)

./curve_builder: curve_builder.o
	$(CXX) -o $@ curve_builder.o $(LDFLAGS) $(MATH_LIBS_ONLY)

./degen_meshes: degen_meshes.o
	$(CXX) -o $@ degen_meshes.o $(LDFLAGS) $(VTK_LIBS) $(MESA_LIBS) $(GL_LIBS) @PTHREAD_LIB@ @X_LIBS@

./distribution_curves: distribution_curves.o
	$(CXX) -o $@ distribution_curves.o $(LDFLAGS) $(MATH_LIBS_ONLY)

./ghost: ghost.o
	$(CXX) -o $@ ghost.o $(LDFLAGS) $(LIBS)

./global_node: global_node.o
	$(CXX) -o $@ global_node.o $(LDFLAGS) $(LIBS)

./globe: globe.o
	$(CXX) -o $@ globe.o $(LDFLAGS) $(LIBS)

./multi_test: multi_test.o
	$(CXX) -o $@ multi_test.o $(LDFLAGS) $(LIBS)

./noise: noise.o
	$(CXX) -o $@ noise.o $(LDFLAGS) $(LIBS)

./noise2d: noise2d.o
	$(CXX) -o $@ noise2d.o $(LDFLAGS) $(LIBS)

./bov: bov.o
	$(CXX) -o $@ bov.o $(LDFLAGS) $(LIBS)

./sid97: sid97.o
	$(CXX) -o $@ sid97.o $(LDFLAGS) $(LIBS)

./specmix: specmix.o
	$(CXX) -o $@ specmix.o $(LDFLAGS) $(LIBS)

./testall: testall.o
	$(CXX) -o $@ testall.o $(LDFLAGS) $(LIBS)

./tire: tire.o
	$(CXX) -o $@ tire.o $(LDFLAGS) $(LIBS)

./wave: wave.o
	$(CXX) -o $@ wave.o $(LDFLAGS) $(LIBS)

./quad_disk: quad_disk.o
	$(CXX) -o $@ quad_disk.o $(LDFLAGS) $(LIBS)

./emptydomains: emptydomains.o
	$(CXX) -o $@ emptydomains.o $(LDFLAGS) $(LIBS)

./galaxy: galaxy.o
	$(CXX) -o $@ galaxy.o $(LDFLAGS) $(LIBS)

# Dummy target to due to fact that pdbdatabase_link.C
# needs to be listed in PDBSRC symbol
./pdbdatabase_link:
	

./pdbdatabase: pdbdatabase.o pdbdatabase_link.o
	$(CXX) -I../include/visit -o $@ pdbdatabase.o $(LDFLAGS) $(LIBS) @PDB_LIBS@ pdbdatabase_link.o

./correlationtest: correlationtest.o pdbdatabase_link.o
	$(CXX) -o $@ correlationtest.o $(LDFLAGS) $(LIBS) @PDB_LIBS@ pdbdatabase_link.o

./streak: streak.o pdbdatabase_link.o
	$(CXX) -o $@ streak.o $(LDFLAGS) $(LIBS) @PDB_LIBS@ pdbdatabase_link.o

./csg:  csg.o
	$(CXX) -o $@ csg.o $(LDFLAGS) $(LIBS)

./lowfrac: lowfrac.o
	$(CXX) -o $@ lowfrac.o $(LDFLAGS) $(LIBS)

./largefile: largefile.o
	$(CXX) -o $@ largefile.o $(LDFLAGS) $(LIBS)

./one_quad: one_quad.o
	$(CXX) -o $@ one_quad.o $(LDFLAGS) $(LIBS)

./fullframe: fullframe.o
	$(CXX) -o $@ fullframe.o $(LDFLAGS) $(LIBS)

./thinplane: thinplane.o
	$(CXX) -o $@ thinplane.o $(LDFLAGS) $(LIBS)

./meshorigin: meshorigin.o
	$(CXX) -o $@ meshorigin.o $(LDFLAGS) $(LIBS)

./lineout_test: lineout_test.o
	$(CXX) -o $@ lineout_test.o $(LDFLAGS) $(LIBS)

./xdmf: xdmf.o
	$(CXX) -o $@ xdmf.o $(LDFLAGS) $(HDF5_LIB) $(ZLIB_LIB) @LIBS@

install_bin: ./bigsil ./distribution_curves ./global_node ./globe ./multi_test ./noise ./noise2d ./sid97 ./specmix ./testall ./tire ./wave ./galaxy ./csg ./lowfrac ./largefile ./one_quad ./fullframe ./thinplane ./meshorigin ./lineout_test
	$(INSTALL) ./bigsil $(bindir)
	$(INSTALL) ./distribution_curves $(bindir)
	$(INSTALL) ./degen_meshes $(bindir)
	$(INSTALL) ./global_node $(bindir)
	$(INSTALL) ./globe $(bindir)
	$(INSTALL) ./multi_test $(bindir)
	$(INSTALL) ./noise $(bindir)
	$(INSTALL) ./noise2d $(bindir)
	$(INSTALL) ./sid97 $(bindir)
	$(INSTALL) ./specmix $(bindir)
	$(INSTALL) ./testall $(bindir)
	$(INSTALL) ./tire $(bindir)
	$(INSTALL) ./wave $(bindir)
	$(INSTALL) ./quad_disk $(bindir)
	$(INSTALL) ./emptydomains $(bindir)
	$(INSTALL) ./galaxy $(bindir)
	$(INSTALL) ./csg $(bindir)
	$(INSTALL) ./lowfrac $(bindir)
	$(INSTALL) ./largefile $(bindir)
	$(INSTALL) ./one_quad $(bindir)
	$(INSTALL) ./fullframe $(bindir)
	$(INSTALL) ./thinplane $(bindir)
	$(INSTALL) ./meshorigin $(bindir)
	$(INSTALL) ./lineout_test $(bindir)

#
# Inference rules for compressed binary data files
#
.SUFFIXES: .tar.gz .tar.bz .tar.bz2 .gz .bz .bz2

.tar.bz2:
	bunzip2 < $@.tar.bz2 | tar xvf -
	touch $@

.tar.bz:
	bunzip < $@.tar.bz | tar xvf -
	touch $@

.tar.gz:
	gunzip < $@.tar.gz | tar xvf -
	touch $@

.bz2:
	bunzip2 < $@.bz2 > $@
	touch $@

.bz:
	bunzip < $@.bz > $@
	touch $@

.gz:
	gunzip < $@.gz > $@
	touch $@

##
## Automatic dependency stuff
##
@TARGETS@
@LIBTARGETS@
